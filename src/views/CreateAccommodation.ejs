<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add new accommodation</title>
  <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@2.0.6/css/pico.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />


  <style>
    #map {
      width: 100%;
      height: 300px;
      margin: 1rem 0;
    }

    form .grid {
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
    }

    form .grid>div {
      width: 100%;
    }

    form .grid label {
      margin-bottom: 0.2rem;
    }

    form .grid input,
    form .grid textarea,
    form .grid select {
      width: 100%;
    }

    form button[type="submit"] {
      margin-top: 1.5rem;
    }
  </style>
</head>

<body>
  <main class="container">
    <h1>Add new aparment</h1>
    <form action="/api/accommodations" method="POST" enctype="multipart/form-data">
      <div class="grid">
        <div>
          <label for="title">Name</label>
          <input type="text" id="title" name="title" required>
        </div>

        <div>
          <label for="pricePerNight">Price per Night</label>
          <input type="number" id="pricePerNight" name="pricePerNight" required>
        </div>
        <div>
          <label for="description">Description</label>
          <textarea id="description" name="description" required></textarea>
        </div>
        <div>
          <label for="mainPhoto">Main Photo (Upload)</label>
          <input type="file" id="mainPhoto" name="mainPhoto" accept="image/*" required>
        </div>
        <div>
          <label for="mainPhotoLabel">Describe Main Photo</label>
          <input type="text" name="mainPhotoLabel" id="mainPhotoLabel" placeholder="e.g., cocina, baño, salón">
        </div>
        <div>
          <label for="photos">Upload Additional Photos</label>
          <input type="file" name="photos" id="photos" accept="image/*" multiple>
        </div>
        <div>
          <label for="photoLabels">Describe Each Photo (separate with commas)</label>
          <input type="text" name="photoLabels" id="photoLabels" placeholder="e.g., cocina, baño, salón">
        </div>
        <div>
          <label for="rooms">Rooms</label>
          <input type="number" id="rooms" name="rooms" required>
        </div>
        <div>
          <label for="beds">Beds</label>
          <input type="number" id="beds" name="beds" required>
        </div>
        <div><label for="maxGuests">Max. Guests</label>
          <input type="number" id="maxGuests" name="maxGuests" min="1" required>
        </div>
        <div>
          <label for="bathrooms">Bathrooms</label>
          <input type="number" id="bathrooms" name="bathrooms" required>
        </div>
        <div><label for="petsAllowed">Pets Allowed</label>
          <select id="petsAllowed" name="petsAllowed" required>
            <option value="true">Yes</option>
            <option value="false">No</option>
          </select>
        </div>
        <div><label for="squareMeters">Square Meters</label>
          <input type="number" id="squareMeters" name="squareMeters" required>
        </div>
        <div>
          <label for="address">Address</label>
          <input type="text" id="address" name="address" required>
        </div>
        <div>
          <label for="city">City</label>
          <input type="text" id="city" name="city" required>
        </div>
        <div>
          <label for="country">Country</label>
          <input type="text" id="country" name="country" required>
        </div>
        <div>
          <label for="postalCode">Postal Code</label>
          <input type="text" id="postalCode" name="postalCode" required>
        </div>
        <h3>Select location on map</h3>
        <div id="map"></div>

        <input type="hidden" name="location.lat" id="lat">
        <input type="hidden" name="location.lng" id="lng">

        <div>
          <label for="propertyType">Property Type</label>
          <select id="propertyType" name="propertyType" required>
            <option value="Apartment">Apartment</option>
            <option value="House">House</option>
            <option value="Studio">Studio</option>
            <option value="Loft">Loft</option>
            <option value="Other">Other</option>
          </select>
        </div>
        <div>
  <label>Available Services (Amenities)</label>
  <div style="display: flex; flex-wrap: wrap; gap: 1.5rem;">
    <% Object.entries(amenityIcons).forEach(([label, icon]) => { %>
      <div style="display: flex; flex-direction: column; align-items: center; width: 70px; text-align: center;">
        <label style="cursor: pointer;" title="<%= label %>">
          <i class="fas <%= icon %>" style="font-size: 1.6rem; color: #444;"></i><br>
          <input type="checkbox" name="amenities" value="<%= label %>" style="margin-top: 0.4rem;">
        </label>
      </div>
    <% }) %>
  </div>
</div>



          <div>
            <label for="houseRules">House Rules</label>
            <textarea id="houseRules" name="houseRules"></textarea>
          </div>
          <div>
            <label for="cancellationPolicy">Cancellation Policy</label>
            <input type="text" id="cancellationPolicy" name="cancellationPolicy">
          </div>
          <div>
            <label for="checkIn">Check-in Time</label>
            <input type="time" id="checkIn" name="checkIn">
          </div>
          <div>
            <label for="checkOut">Check-out Time</label>
            <input type="time" id="checkOut" name="checkOut">
          </div>
        </div>
        <button type="submit">Add accommodation</button>
    </form>
  </main>
  <script src="https://maps.googleapis.com/maps/api/js?key=<%= googleMapsApiKey %>&callback=initMap" async
    defer></script>
  <script>

    function initMap() {
      const defaultLocation = { lat: 41.3851, lng: 2.1734 }; // Barcelona
      const map = new google.maps.Map(document.getElementById("map"), {
        center: defaultLocation,
        zoom: 10,
      });

      let marker;

      map.addListener("click", function (e) {
        const lat = e.latLng.lat();
        const lng = e.latLng.lng();

        // Actualiza inputs ocultos
        document.getElementById("lat").value = lat;
        document.getElementById("lng").value = lng;

        // Añade marcador
        if (marker) marker.setMap(null);
        marker = new google.maps.Marker({
          position: { lat, lng },
          map,
        });
      });
    }
  </script>
</body>

</html>